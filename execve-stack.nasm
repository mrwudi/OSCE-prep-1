section .mytext progbits alloc exec write align=16 ; allow stack writing
; have to change from .text or linker overrides "write"
global _start
_start:

	xor eax, eax
	push eax

	push 0x68736162	; hsab
	push 0x2f6e6962	; /nib
	push 0x2f2f2f2f ; ////

; reasoning: we need to push to the stack in multiples of 4
; /bin/bash is 9 bytes, so three / are added to make 12
; the OS doesn't care about the extra /, the string executes normally

	mov ebx, esp	; load "////bin/bash, 0x00000000" into ebx

	push eax
	mov edx, esp	; load "0x00000000" into edx

	push ebx	; ebx already points to /bin/bash so we push that

	mov ecx, esp	; move everything on the stack to ecx

	mov al, 0xb
	int 0x80

